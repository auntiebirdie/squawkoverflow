<%- include('../header.ejs') %>

  <%- include('../partials/page-title.ejs', { title : { text : `${egg.name} Egg`, prepend : `<img class="me-2" style="height: 4rem;" src="/img/eggs/${egg.icon ? egg.name : 'default'}.png">` }, breadcrumb : { text : "Birdypedia Egg Guide", url: '/birdypedia/eggs' } }) %>

  <div id="lazyLoader" class="row" data-endpoint="/api/birdypedia"></div>

  <%- include('../scripts/lazyloader.ejs', { template: '../templates/birdypedia.ejs', skipParams : true }) %>

  <script type="text/javascript">
    $('#lazyLoader').on('click', '.wishlist-heart', function (event) {
      var button = event.target;

      if (!button.style.opacity) { 
        var action = button.getAttribute('data-action');
        button.style.opacity = .5;

        $.ajax({
          url: `/api/wishlist/${action}/${button.getAttribute('data-id')}`,
          method: 'post',
          dataType: "json",
          success: function(data) {
            button.style.opacity = null;
            if (action == "add") {
              button.innerHTML = "‚ù§Ô∏è";
              button.setAttribute('data-action', 'remove');
            }
            else {
              button.innerHTML = "ü§ç";
              button.setAttribute('data-action', 'add');
            }
          }
        });
      }
    });

    $('#lazyLoader').on('click', '.birdypet.mini', function (event) {
      var variant = event.target;
      var full = variant.parentNode.parentNode.parentNode.querySelector('.birdypet');
      full.style.backgroundImage = variant.style.backgroundImage;
      if (variant.className.includes('unhatched')) {
        $(full).removeClass('hatched').addClass('unhatched');
      }
      else {
        $(full).removeClass('unhatched').addClass('hatched');
      }
    });
  </script>

<%- include('../footer.ejs') %>
